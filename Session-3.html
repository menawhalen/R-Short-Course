<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Session 3</title>

<!-- HEAD_CONTENT -->

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div id="section-header">



<h1 class="title toc-ignore">Session 3</h1>

</div>


<div id="section-inner-join" class="section level2">
<h2>Inner Join</h2>
<p>Inner joins return results if the keys are matched in BOTH
tables.</p>
<pre class="r"><code>library(tidyverse)
library(mdsr)
library(nycflights13)

head(airlines)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["carrier"],"name":[1],"type":["chr"],"align":["left"]},{"label":["name"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"9E","2":"Endeavor Air Inc."},{"1":"AA","2":"American Airlines Inc."},{"1":"AS","2":"Alaska Airlines Inc."},{"1":"B6","2":"JetBlue Airways"},{"1":"DL","2":"Delta Air Lines Inc."},{"1":"EV","2":"ExpressJet Airlines Inc."}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>head(flights)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["year"],"name":[1],"type":["int"],"align":["right"]},{"label":["month"],"name":[2],"type":["int"],"align":["right"]},{"label":["day"],"name":[3],"type":["int"],"align":["right"]},{"label":["dep_time"],"name":[4],"type":["int"],"align":["right"]},{"label":["sched_dep_time"],"name":[5],"type":["int"],"align":["right"]},{"label":["dep_delay"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["arr_time"],"name":[7],"type":["int"],"align":["right"]},{"label":["sched_arr_time"],"name":[8],"type":["int"],"align":["right"]},{"label":["arr_delay"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["carrier"],"name":[10],"type":["chr"],"align":["left"]},{"label":["flight"],"name":[11],"type":["int"],"align":["right"]},{"label":["tailnum"],"name":[12],"type":["chr"],"align":["left"]},{"label":["origin"],"name":[13],"type":["chr"],"align":["left"]},{"label":["dest"],"name":[14],"type":["chr"],"align":["left"]},{"label":["air_time"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["distance"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["hour"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["minute"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["time_hour"],"name":[19],"type":["dttm"],"align":["right"]}],"data":[{"1":"2013","2":"1","3":"1","4":"517","5":"515","6":"2","7":"830","8":"819","9":"11","10":"UA","11":"1545","12":"N14228","13":"EWR","14":"IAH","15":"227","16":"1400","17":"5","18":"15","19":"2013-01-01 05:00:00"},{"1":"2013","2":"1","3":"1","4":"533","5":"529","6":"4","7":"850","8":"830","9":"20","10":"UA","11":"1714","12":"N24211","13":"LGA","14":"IAH","15":"227","16":"1416","17":"5","18":"29","19":"2013-01-01 05:00:00"},{"1":"2013","2":"1","3":"1","4":"542","5":"540","6":"2","7":"923","8":"850","9":"33","10":"AA","11":"1141","12":"N619AA","13":"JFK","14":"MIA","15":"160","16":"1089","17":"5","18":"40","19":"2013-01-01 05:00:00"},{"1":"2013","2":"1","3":"1","4":"544","5":"545","6":"-1","7":"1004","8":"1022","9":"-18","10":"B6","11":"725","12":"N804JB","13":"JFK","14":"BQN","15":"183","16":"1576","17":"5","18":"45","19":"2013-01-01 05:00:00"},{"1":"2013","2":"1","3":"1","4":"554","5":"600","6":"-6","7":"812","8":"837","9":"-25","10":"DL","11":"461","12":"N668DN","13":"LGA","14":"ATL","15":"116","16":"762","17":"6","18":"0","19":"2013-01-01 06:00:00"},{"1":"2013","2":"1","3":"1","4":"554","5":"558","6":"-4","7":"740","8":"728","9":"12","10":"UA","11":"1696","12":"N39463","13":"EWR","14":"ORD","15":"150","16":"719","17":"5","18":"58","19":"2013-01-01 05:00:00"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>#Old school
flights_joined &lt;- merge(flights, airlines, by.x = &quot;carrier&quot;, by.y = &quot;carrier&quot;)
glimpse(flights_joined)</code></pre>
<pre><code>## Rows: 336,776
## Columns: 20
## $ carrier        &lt;chr&gt; &quot;9E&quot;, &quot;9E&quot;, &quot;9E&quot;, &quot;9E&quot;, &quot;9E&quot;, &quot;9E&quot;, &quot;9E&quot;, &quot;9E&quot;, &quot;9E&quot;, &quot;…
## $ year           &lt;int&gt; 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2…
## $ month          &lt;int&gt; 2, 8, 6, 10, 7, 2, 1, 12, 5, 5, 1, 5, 7, 1, 4, 8, 5, 7,…
## $ day            &lt;int&gt; 5, 23, 2, 26, 7, 18, 19, 19, 26, 29, 16, 12, 30, 15, 20…
## $ dep_time       &lt;int&gt; 827, 1901, 805, 2139, NA, 1459, 1806, 1912, 1903, 934, …
## $ sched_dep_time &lt;int&gt; 830, 1905, 810, 1935, 2030, 1505, 1810, 1915, 1859, 940…
## $ dep_delay      &lt;dbl&gt; -3, -4, -5, 124, NA, -6, -4, -3, 4, -6, -7, 0, 198, -4,…
## $ arr_time       &lt;int&gt; 1032, 2051, 949, 2358, NA, 1621, 2035, 2115, 2048, 1049…
## $ sched_arr_time &lt;int&gt; 1023, 2103, 1027, 2145, 2156, 1637, 2035, 2122, 2059, 1…
## $ arr_delay      &lt;dbl&gt; 9, -12, -38, 133, NA, -16, 0, -7, -11, -6, -3, -23, 153…
## $ flight         &lt;int&gt; 4220, 3360, 3538, 3470, 4218, 3393, 3542, 2931, 3455, 3…
## $ tailnum        &lt;chr&gt; &quot;N8698A&quot;, &quot;N926XJ&quot;, &quot;N925XJ&quot;, &quot;N928XJ&quot;, NA, &quot;N910XJ&quot;, &quot;…
## $ origin         &lt;chr&gt; &quot;JFK&quot;, &quot;JFK&quot;, &quot;JFK&quot;, &quot;JFK&quot;, &quot;JFK&quot;, &quot;JFK&quot;, &quot;JFK&quot;, &quot;JFK&quot;,…
## $ dest           &lt;chr&gt; &quot;RDU&quot;, &quot;PIT&quot;, &quot;MSP&quot;, &quot;CVG&quot;, &quot;PHL&quot;, &quot;DCA&quot;, &quot;MSP&quot;, &quot;PIT&quot;,…
## $ air_time       &lt;dbl&gt; 78, 61, 145, 102, NA, 46, 167, 71, 62, 36, 77, 38, 36, …
## $ distance       &lt;dbl&gt; 427, 340, 1029, 589, 94, 213, 1029, 340, 340, 94, 340, …
## $ hour           &lt;dbl&gt; 8, 19, 8, 19, 20, 15, 18, 19, 18, 9, 7, 16, 19, 8, 9, 1…
## $ minute         &lt;dbl&gt; 30, 5, 10, 35, 30, 5, 10, 15, 59, 40, 50, 10, 30, 20, 5…
## $ time_hour      &lt;dttm&gt; 2013-02-05 08:00:00, 2013-08-23 19:00:00, 2013-06-02 0…
## $ name           &lt;chr&gt; &quot;Endeavor Air Inc.&quot;, &quot;Endeavor Air Inc.&quot;, &quot;Endeavor Air…</code></pre>
<pre class="r"><code>flights_joined %&gt;% 
  select(carrier, name, flight, origin, dest) %&gt;% 
  head(3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["carrier"],"name":[1],"type":["chr"],"align":["left"]},{"label":["name"],"name":[2],"type":["chr"],"align":["left"]},{"label":["flight"],"name":[3],"type":["int"],"align":["right"]},{"label":["origin"],"name":[4],"type":["chr"],"align":["left"]},{"label":["dest"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"9E","2":"Endeavor Air Inc.","3":"4220","4":"JFK","5":"RDU","_rn_":"1"},{"1":"9E","2":"Endeavor Air Inc.","3":"3360","4":"JFK","5":"PIT","_rn_":"2"},{"1":"9E","2":"Endeavor Air Inc.","3":"3538","4":"JFK","5":"MSP","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>#Tidyverse way
flights_joined &lt;- flights %&gt;% 
  inner_join(airlines, by = c(&quot;carrier&quot; = &quot;carrier&quot;))
glimpse(flights_joined)</code></pre>
<pre><code>## Rows: 336,776
## Columns: 20
## $ year           &lt;int&gt; 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2…
## $ month          &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ day            &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ dep_time       &lt;int&gt; 517, 533, 542, 544, 554, 554, 555, 557, 557, 558, 558, …
## $ sched_dep_time &lt;int&gt; 515, 529, 540, 545, 600, 558, 600, 600, 600, 600, 600, …
## $ dep_delay      &lt;dbl&gt; 2, 4, 2, -1, -6, -4, -5, -3, -3, -2, -2, -2, -2, -2, -1…
## $ arr_time       &lt;int&gt; 830, 850, 923, 1004, 812, 740, 913, 709, 838, 753, 849,…
## $ sched_arr_time &lt;int&gt; 819, 830, 850, 1022, 837, 728, 854, 723, 846, 745, 851,…
## $ arr_delay      &lt;dbl&gt; 11, 20, 33, -18, -25, 12, 19, -14, -8, 8, -2, -3, 7, -1…
## $ carrier        &lt;chr&gt; &quot;UA&quot;, &quot;UA&quot;, &quot;AA&quot;, &quot;B6&quot;, &quot;DL&quot;, &quot;UA&quot;, &quot;B6&quot;, &quot;EV&quot;, &quot;B6&quot;, &quot;…
## $ flight         &lt;int&gt; 1545, 1714, 1141, 725, 461, 1696, 507, 5708, 79, 301, 4…
## $ tailnum        &lt;chr&gt; &quot;N14228&quot;, &quot;N24211&quot;, &quot;N619AA&quot;, &quot;N804JB&quot;, &quot;N668DN&quot;, &quot;N394…
## $ origin         &lt;chr&gt; &quot;EWR&quot;, &quot;LGA&quot;, &quot;JFK&quot;, &quot;JFK&quot;, &quot;LGA&quot;, &quot;EWR&quot;, &quot;EWR&quot;, &quot;LGA&quot;,…
## $ dest           &lt;chr&gt; &quot;IAH&quot;, &quot;IAH&quot;, &quot;MIA&quot;, &quot;BQN&quot;, &quot;ATL&quot;, &quot;ORD&quot;, &quot;FLL&quot;, &quot;IAD&quot;,…
## $ air_time       &lt;dbl&gt; 227, 227, 160, 183, 116, 150, 158, 53, 140, 138, 149, 1…
## $ distance       &lt;dbl&gt; 1400, 1416, 1089, 1576, 762, 719, 1065, 229, 944, 733, …
## $ hour           &lt;dbl&gt; 5, 5, 5, 5, 6, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 5, 6, 6, 6…
## $ minute         &lt;dbl&gt; 15, 29, 40, 45, 0, 58, 0, 0, 0, 0, 0, 0, 0, 0, 0, 59, 0…
## $ time_hour      &lt;dttm&gt; 2013-01-01 05:00:00, 2013-01-01 05:00:00, 2013-01-01 0…
## $ name           &lt;chr&gt; &quot;United Air Lines Inc.&quot;, &quot;United Air Lines Inc.&quot;, &quot;Amer…</code></pre>
<pre class="r"><code>flights_joined %&gt;% 
  select(carrier, name, flight, origin, dest) %&gt;% 
  head(3)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["carrier"],"name":[1],"type":["chr"],"align":["left"]},{"label":["name"],"name":[2],"type":["chr"],"align":["left"]},{"label":["flight"],"name":[3],"type":["int"],"align":["right"]},{"label":["origin"],"name":[4],"type":["chr"],"align":["left"]},{"label":["dest"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"UA","2":"United Air Lines Inc.","3":"1545","4":"EWR","5":"IAH"},{"1":"UA","2":"United Air Lines Inc.","3":"1714","4":"LGA","5":"IAH"},{"1":"AA","2":"American Airlines Inc.","3":"1141","4":"JFK","5":"MIA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>#Same number of rows.  Why?  
nrow(flights)</code></pre>
<pre><code>## [1] 336776</code></pre>
<pre class="r"><code>nrow(flights_joined)</code></pre>
<pre><code>## [1] 336776</code></pre>
<p>“In an inner_join(), the result set contains only those rows that
have matches in both tables. In this case, all of the rows in flights
have exactly one corresponding entry in airlines, so the number of rows
in flights_joined is the same as the number of rows in flights (this
will not always be the case).”</p>
<p><strong><em>It is always a good idea to carefully check that the
number of rows returned by a join operation is what you expected. In
particular, you should carefully check for rows in one table that
matched to more than one row in the other table</em></strong></p>
</div>
<div id="section-left-join" class="section level2">
<h2>Left Join</h2>
<p>“Here the rows of the first table are always returned, regardless of
whether there is a match in the second table.”</p>
<pre class="r"><code>#Airports in the pacific time zone only 
airports_pt &lt;- airports %&gt;%
  filter(tz == -8) %&gt;% select(faa, name, tz)
nrow(airports_pt)</code></pre>
<pre><code>## [1] 178</code></pre>
<pre class="r"><code>head(airports_pt)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["faa"],"name":[1],"type":["chr"],"align":["left"]},{"label":["name"],"name":[2],"type":["chr"],"align":["left"]},{"label":["tz"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"0S9","2":"Jefferson County Intl","3":"-8"},{"1":"1C9","2":"Frazier Lake Airpark","3":"-8"},{"1":"1RL","2":"Point Roberts Airpark","3":"-8"},{"1":"38W","2":"Lynden Airport","3":"-8"},{"1":"49X","2":"Chemehuevi Valley","3":"-8"},{"1":"55S","2":"Packwood","3":"-8"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>#If we do inner join
nyc_dests_pt &lt;- flights %&gt;% 
  inner_join(airports_pt, by = c(&quot;dest&quot; = &quot;faa&quot;)) %&gt;% select(name, tz, dest, dep_time,sched_dep_time, arr_time, sched_arr_time, carrier)
head(nyc_dests_pt)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["tz"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["dest"],"name":[3],"type":["chr"],"align":["left"]},{"label":["dep_time"],"name":[4],"type":["int"],"align":["right"]},{"label":["sched_dep_time"],"name":[5],"type":["int"],"align":["right"]},{"label":["arr_time"],"name":[6],"type":["int"],"align":["right"]},{"label":["sched_arr_time"],"name":[7],"type":["int"],"align":["right"]},{"label":["carrier"],"name":[8],"type":["chr"],"align":["left"]}],"data":[{"1":"Los Angeles Intl","2":"-8","3":"LAX","4":"558","5":"600","6":"924","7":"917","8":"UA"},{"1":"San Francisco Intl","2":"-8","3":"SFO","4":"558","5":"600","6":"923","7":"937","8":"UA"},{"1":"Mc Carran Intl","2":"-8","3":"LAS","4":"559","5":"600","6":"854","7":"902","8":"UA"},{"1":"San Francisco Intl","2":"-8","3":"SFO","4":"611","5":"600","6":"945","7":"931","8":"UA"},{"1":"Los Angeles Intl","2":"-8","3":"LAX","4":"628","5":"630","6":"1016","7":"947","8":"UA"},{"1":"John Wayne Arpt Orange Co","2":"-8","3":"SNA","4":"646","5":"645","6":"1023","7":"1030","8":"UA"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>#Notice these are different.  
#key variable needs to be in BOTH data sets to get returned.  
nrow(flights)</code></pre>
<pre><code>## [1] 336776</code></pre>
<pre class="r"><code>nrow(nyc_dests_pt)</code></pre>
<pre><code>## [1] 46324</code></pre>
<pre class="r"><code>nyc_dests &lt;- flights %&gt;% 
  left_join(airports_pt, by = c(&quot;dest&quot; = &quot;faa&quot;))</code></pre>
<pre class="r"><code>#Notice these are the same!
nrow(flights)</code></pre>
<pre><code>## [1] 336776</code></pre>
<pre class="r"><code>nrow(nyc_dests)</code></pre>
<pre><code>## [1] 336776</code></pre>
<pre class="r"><code>nyc_dests %&gt;%
  summarize(
    num_flights = n(),
    num_flights_pt = sum(!is.na(name)),
    num_flights_not_pt = sum(is.na(name))
  )</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["num_flights"],"name":[1],"type":["int"],"align":["right"]},{"label":["num_flights_pt"],"name":[2],"type":["int"],"align":["right"]},{"label":["num_flights_not_pt"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"336776","2":"46324","3":"290452"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>library(Lahman)
#Let&#39;s look at Manny Ramirez
manny &lt;- Batting %&gt;%
  filter(playerID == &quot;ramirma02&quot;)
nrow(manny)</code></pre>
<pre><code>## [1] 21</code></pre>
<pre class="r"><code>People %&gt;% 
  filter(nameLast == &quot;Ramirez&quot; &amp; nameFirst == &quot;Manny&quot;)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["playerID"],"name":[1],"type":["chr"],"align":["left"]},{"label":["birthYear"],"name":[2],"type":["int"],"align":["right"]},{"label":["birthMonth"],"name":[3],"type":["int"],"align":["right"]},{"label":["birthDay"],"name":[4],"type":["int"],"align":["right"]},{"label":["birthCountry"],"name":[5],"type":["chr"],"align":["left"]},{"label":["birthState"],"name":[6],"type":["chr"],"align":["left"]},{"label":["birthCity"],"name":[7],"type":["chr"],"align":["left"]},{"label":["deathYear"],"name":[8],"type":["int"],"align":["right"]},{"label":["deathMonth"],"name":[9],"type":["int"],"align":["right"]},{"label":["deathDay"],"name":[10],"type":["int"],"align":["right"]},{"label":["deathCountry"],"name":[11],"type":["chr"],"align":["left"]},{"label":["deathState"],"name":[12],"type":["chr"],"align":["left"]},{"label":["deathCity"],"name":[13],"type":["chr"],"align":["left"]},{"label":["nameFirst"],"name":[14],"type":["chr"],"align":["left"]},{"label":["nameLast"],"name":[15],"type":["chr"],"align":["left"]},{"label":["nameGiven"],"name":[16],"type":["chr"],"align":["left"]},{"label":["weight"],"name":[17],"type":["int"],"align":["right"]},{"label":["height"],"name":[18],"type":["int"],"align":["right"]},{"label":["bats"],"name":[19],"type":["fct"],"align":["left"]},{"label":["throws"],"name":[20],"type":["fct"],"align":["left"]},{"label":["debut"],"name":[21],"type":["chr"],"align":["left"]},{"label":["finalGame"],"name":[22],"type":["chr"],"align":["left"]},{"label":["retroID"],"name":[23],"type":["chr"],"align":["left"]},{"label":["bbrefID"],"name":[24],"type":["chr"],"align":["left"]},{"label":["deathDate"],"name":[25],"type":["date"],"align":["right"]},{"label":["birthDate"],"name":[26],"type":["date"],"align":["right"]}],"data":[{"1":"ramirma02","2":"1972","3":"5","4":"30","5":"D.R.","6":"Distrito Nacional","7":"Santo Domingo","8":"NA","9":"NA","10":"NA","11":"NA","12":"NA","13":"NA","14":"Manny","15":"Ramirez","16":"Manuel Aristides","17":"225","18":"72","19":"R","20":"R","21":"1993-09-02","22":"2011-04-06","23":"ramim002","24":"ramirma02","25":"<NA>","26":"1972-05-30"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>#Question 1: How many years did Manny Ramirez hit more than 30 HRs?
#Question 2: In terms of number of HRs hit, what AGES were his five best? 
#Question 3: What fraction of total homeruns in the league did Manny hit in each of his seasons?   </code></pre>
<pre class="r"><code>manny_people &lt;- People %&gt;% 
  filter(nameLast == &quot;Ramirez&quot; &amp; nameFirst == &quot;Manny&quot;)


manny %&gt;% group_by(yearID) %&gt;% summarise(HRt = sum(HR)) %&gt;% filter(HRt &gt; 30)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["yearID"],"name":[1],"type":["int"],"align":["right"]},{"label":["HRt"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"1995","2":"31"},{"1":"1996","2":"33"},{"1":"1998","2":"45"},{"1":"1999","2":"44"},{"1":"2000","2":"38"},{"1":"2001","2":"41"},{"1":"2002","2":"33"},{"1":"2003","2":"37"},{"1":"2004","2":"43"},{"1":"2005","2":"45"},{"1":"2006","2":"35"},{"1":"2008","2":"37"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>#Ages
manny %&gt;% left_join(manny_people, by = c(&quot;playerID&quot; = &quot;playerID&quot;)) %&gt;% mutate(age = yearID - birthYear) %&gt;% group_by(age) %&gt;% summarise(HRt = sum(HR)) %&gt;% arrange(desc(HRt))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["age"],"name":[1],"type":["int"],"align":["right"]},{"label":["HRt"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"26","2":"45"},{"1":"33","2":"45"},{"1":"27","2":"44"},{"1":"32","2":"43"},{"1":"29","2":"41"},{"1":"28","2":"38"},{"1":"31","2":"37"},{"1":"36","2":"37"},{"1":"34","2":"35"},{"1":"24","2":"33"},{"1":"30","2":"33"},{"1":"23","2":"31"},{"1":"25","2":"26"},{"1":"35","2":"20"},{"1":"37","2":"19"},{"1":"22","2":"17"},{"1":"38","2":"9"},{"1":"21","2":"2"},{"1":"39","2":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>#
lg &lt;- Batting %&gt;% 
  group_by(yearID) %&gt;% summarise(HRt_league = sum(HR))

manny_tot &lt;- manny %&gt;% group_by(yearID) %&gt;% summarise(HRt_manny = sum(HR)) 
manny_tot %&gt;% left_join(lg, by = c(&quot;yearID&quot; = &quot;yearID&quot;)) %&gt;% mutate(fraction = HRt_manny/HRt_league) %&gt;% arrange(desc(fraction))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["yearID"],"name":[1],"type":["int"],"align":["right"]},{"label":["HRt_manny"],"name":[2],"type":["int"],"align":["right"]},{"label":["HRt_league"],"name":[3],"type":["int"],"align":["right"]},{"label":["fraction"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"2005","2":"45","3":"5017","4":"0.0089695037"},{"1":"1998","2":"45","3":"5064","4":"0.0088862559"},{"1":"1999","2":"44","3":"5528","4":"0.0079594790"},{"1":"2004","2":"43","3":"5451","4":"0.0078884608"},{"1":"1995","2":"31","3":"4081","4":"0.0075961774"},{"1":"2008","2":"37","3":"4878","4":"0.0075850759"},{"1":"2001","2":"41","3":"5458","4":"0.0075119091"},{"1":"2003","2":"37","3":"5207","4":"0.0071058191"},{"1":"2000","2":"38","3":"5693","4":"0.0066748639"},{"1":"1996","2":"33","3":"4962","4":"0.0066505441"},{"1":"2002","2":"33","3":"5059","4":"0.0065230283"},{"1":"2006","2":"35","3":"5386","4":"0.0064983290"},{"1":"1997","2":"26","3":"4640","4":"0.0056034483"},{"1":"1994","2":"17","3":"3306","4":"0.0051421658"},{"1":"2007","2":"20","3":"4957","4":"0.0040346984"},{"1":"2009","2":"19","3":"5042","4":"0.0037683459"},{"1":"2010","2":"9","3":"4613","4":"0.0019510080"},{"1":"1993","2":"2","3":"4030","4":"0.0004962779"},{"1":"2011","2":"0","3":"4552","4":"0.0000000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>
<script type="application/shiny-prerendered" data-context="server-start">
library(learnr)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::register_http_handlers(session, metadata = NULL)
</script>


<script type="application/shiny-prerendered" data-context="server">
learnr:::prepare_tutorial_state(session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::i18n_observe_tutorial_language(input, session)
</script>


<script type="application/shiny-prerendered" data-context="server">
session$onSessionEnded(function() {
        learnr:::event_trigger(session, "session_stop")
      })
</script>
</p>
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["header-attrs"]},{"type":"character","attributes":{},"value":["2.23"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pandoc"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["header-attrs.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.23"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","shim/html5shiv.min.js","shim/respond.min.js"]},{"type":"character","attributes":{},"value":["css/bootstrap.min.css"]},{"type":"character","attributes":{},"value":["<style>h1 {font-size: 34px;}\n       h1.title {font-size: 38px;}\n       h2 {font-size: 30px;}\n       h3 {font-size: 24px;}\n       h4 {font-size: 18px;}\n       h5 {font-size: 16px;}\n       h6 {font-size: 12px;}\n       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}\n       pre:not([class]) { background-color: white }<\/style>"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.23"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["navigation"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/navigation-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tabsets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.23"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["default.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.23"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["pagedtable"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pagedtable-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/pagedtable.js"]},{"type":"character","attributes":{},"value":["css/pagedtable.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.23"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["font-awesome"]},{"type":"character","attributes":{},"value":["6.4.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fontawesome"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/all.min.css","css/v4-shims.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fontawesome"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootbox"]},{"type":"character","attributes":{},"value":["5.5.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/bootbox"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["bootbox.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["idb-keyvalue"]},{"type":"character","attributes":{},"value":["3.2.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/idb-keyval"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["idb-keyval-iife-compat.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.11.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.11.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.4"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74]}},"value":[{"type":"character","attributes":{},"value":["base","base64enc","bslib","cachem","cli","colorspace","compiler","datasets","digest","dplyr","ellipsis","evaluate","fansi","fastmap","fontawesome","forcats","generics","ggplot2","glue","graphics","grDevices","grid","gtable","hms","htmltools","htmlwidgets","httpuv","jquerylib","jsonlite","knitr","Lahman","later","learnr","lifecycle","lubridate","magrittr","mdsr","methods","mime","munsell","nycflights13","pillar","pkgconfig","promises","purrr","R6","Rcpp","readr","repr","rlang","rmarkdown","rprojroot","rstudioapi","sass","scales","shiny","skimr","stats","stringi","stringr","tibble","tidyr","tidyselect","tidyverse","timechange","tools","tzdb","utf8","utils","vctrs","withr","xfun","xtable","yaml"]},{"type":"character","attributes":{},"value":["4.2.3","0.1-3","0.5.0","1.0.8","3.6.0","2.1-0","4.2.3","4.2.3","0.6.31","1.1.2","0.3.2","0.21","1.0.4","1.1.1","0.5.1","1.0.0","0.1.3","3.4.2","1.6.2","4.2.3","4.2.3","4.2.3","0.3.3","1.1.3","0.5.5","1.6.2","1.6.11","0.1.4","1.8.7","1.43","11.0-0","1.3.1","0.11.4","1.0.3","1.9.2","2.0.3","0.2.7","4.2.3","0.12","0.5.0","1.0.2","1.9.0","2.0.3","1.2.0.1","1.0.1","2.5.1","1.0.10","2.1.4","1.1.6","1.1.1","2.23","2.0.3","0.15.0","0.4.7","1.2.1","1.7.4.1","2.1.5","4.2.3","1.7.12","1.5.0","3.2.1","1.3.0","1.2.0","2.0.0","0.2.0","4.2.3","0.4.0","1.2.3","4.2.3","0.6.2","2.5.0","0.39","1.8-4","2.3.7"]}]}]}
</script>
<!--/html_preserve-->
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("section-TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
